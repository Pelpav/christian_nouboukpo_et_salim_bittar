<!DOCTYPE html>
{% load static %}
<html lang="fr">
  <head>
    <title>{% block title %}Carbook{% endblock title %}</title>
    <meta charset="utf-8" />
    <meta
      name="viewport"
      content="width=device-width, initial-scale=1, shrink-to-fit=no"
    />

    {% block extraStyle %}
    <link
      href="https://fonts.googleapis.com/css?family=Poppins:200,300,400,500,600,700,800&display=swap"
      rel="stylesheet"
    />
    <link
      rel="stylesheet"
      href="{% static 'css/open-iconic-bootstrap.min.css' %}"
    />
    <link rel="stylesheet" href="{% static 'css/animate.css' %}" />
    <link rel="stylesheet" href="{% static 'css/owl.carousel.min.css' %}" />
    <link
      rel="stylesheet"
      href="{% static 'css/owl.theme.default.min.css' %}"
    />
    <link rel="stylesheet" href="{% static 'css/magnific-popup.css' %}" />
    <link rel="stylesheet" href="{% static 'css/aos.css' %}" />
    <link rel="stylesheet" href="{% static 'css/ionicons.min.css' %}" />
    <link rel="stylesheet" href="{% static 'css/bootstrap-datepicker.css' %}" />
    <link rel="stylesheet" href="{% static 'css/jquery.timepicker.css' %}" />
    <link rel="stylesheet" href="{% static 'css/flaticon.css' %}" />
    <link rel="stylesheet" href="{% static 'css/icomoon.css' %}" />
    <link rel="stylesheet" href="{% static 'css/style.css' %}" />
    {% endblock extraStyle %}
  </head>
  <body>
    {% block navbar %}
    <nav
      class="navbar navbar-expand-lg navbar-dark ftco_navbar bg-dark ftco-navbar-light"
      id="ftco-navbar"
    >
      <div class="container">
        <a class="navbar-brand" href="{% url 'home' %}">Car<span>Book</span></a>
        <button
          class="navbar-toggler"
          type="button"
          data-toggle="collapse"
          data-target="#ftco-nav"
          aria-controls="ftco-nav"
          aria-expanded="false"
          aria-label="Toggle navigation"
        >
          <span class="oi oi-menu"></span> Menu
        </button>
        <div class="collapse navbar-collapse" id="ftco-nav">
          <ul class="navbar-nav ml-auto">
            <li
              class="nav-item {% if request.resolver_match.url_name == 'home' %}active{% endif %}"
            >
              <a href="{% url 'home' %}" class="nav-link">Accueil</a>
            </li>
            <li
              class="nav-item {% if request.resolver_match.url_name == 'about' %}active{% endif %}"
            >
              <a href="{% url 'about' %}" class="nav-link">À propos</a>
            </li>
            <li
              class="nav-item {% if request.resolver_match.url_name == 'cars' %}active{% endif %}"
            >
              <a href="{% url 'cars' %}" class="nav-link">Voitures</a>
            </li>
            <li
              class="nav-item {% if request.resolver_match.url_name == 'contact' %}active{% endif %}"
            >
              <a href="{% url 'contact' %}" class="nav-link">Contact</a>
            </li>
            <li
              class="nav-item {% if request.resolver_match.url_name == 'cart' %}active{% endif %}"
            >
              <a href="{% url 'cart' %}" class="nav-link">
                <span class="oi oi-cart"></span> <!-- Icône du panier -->
                (<span id="cart-count">0</span>) <!-- Compteur d'éléments dans le panier -->
              </a>
            </li>
            <li class="nav-item dropdown">
              <a
                class="nav-link dropdown-toggle"
                href="#"
                id="userDropdown"
                role="button"
                data-toggle="dropdown"
                aria-haspopup="true"
                aria-expanded="false"
              >
                <span class="oi oi-person"></span>
                {% if user.is_authenticated %} {{ user.username }} {% else %}
                Compte {% endif %}
              </a>
              <div
                class="dropdown-menu dropdown-menu-right animate slideIn"
                aria-labelledby="userDropdown"
              >
                {% if user.is_authenticated %}
                <form
                  action="{% url 'logout' %}"
                  method="post"
                  style="display: inline"
                >
                  {% csrf_token %}
                  <button type="submit" class="dropdown-item">
                    Se déconnecter
                  </button>
                </form>
                {% else %}
                <a class="dropdown-item" href="{% url 'login' %}"
                  >Se connecter</a
                >
                <a class="dropdown-item" href="{% url 'register' %}"
                  >S'inscrire</a
                >
                {% endif %}
              </div>
            </li>
          </ul>
        </div>
      </div>
    </nav>
    <!-- END nav -->
    {% endblock navbar %} {% block content %} {% endblock content %} {% block footer %}
    <footer class="ftco-footer ftco-bg-dark ftco-section">
      <div class="container">
        <div class="row mb-5">
          <div class="col-md">
            <div class="ftco-footer-widget mb-4">
              <h2 class="ftco-heading-2">
                <a href="#" class="logo">Car<span>book</span></a>
              </h2>
              <p>
                Far far away, behind the word mountains, far from the countries
                Vokalia and Consonantia, there live the blind texts.
              </p>
              <ul
                class="ftco-footer-social list-unstyled float-md-left float-lft mt-5"
              >
                <li class="ftco-animate">
                  <a href="#"><span class="icon-twitter"></span></a>
                </li>
                <li class="ftco-animate">
                  <a href="#"><span class="icon-facebook"></span></a>
                </li>
                <li class="ftco-animate">
                  <a href="#"><span class="icon-instagram"></span></a>
                </li>
              </ul>
            </div>
          </div>
          <div class="col-md">
            <div class="ftco-footer-widget mb-4 ml-md-5">
              <h2 class="ftco-heading-2">Informations</h2>
              <ul class="list-unstyled">
                <li>
                  <a href="{% url 'about' %}" class="py-2 d-block">À propos</a>
                </li>
                <li>
                  <a href="{% url 'services' %}" class="py-2 d-block"
                    >Services</a
                  >
                </li>
                <li>
                  <a href="#" class="py-2 d-block">Conditions générales</a>
                </li>
                <li>
                  <a href="#" class="py-2 d-block"
                    >Meilleure garantie de prix</a
                  >
                </li>
                <li>
                  <a href="#" class="py-2 d-block"
                    >Politique de confidentialité et cookies</a
                  >
                </li>
              </ul>
            </div>
          </div>
          <div class="col-md">
            <div class="ftco-footer-widget mb-4">
              <h2 class="ftco-heading-2">Support client</h2>
              <ul class="list-unstyled">
                <li><a href="#" class="py-2 d-block">FAQ</a></li>
                <li>
                  <a href="#" class="py-2 d-block">Options de paiement</a>
                </li>
                <li>
                  <a href="#" class="py-2 d-block">Conseils de réservation</a>
                </li>
                <li><a href="#" class="py-2 d-block">Comment ça marche</a></li>
                <li><a href="#" class="py-2 d-block">Contactez-nous</a></li>
              </ul>
            </div>
          </div>
          <div class="col-md">
            <div class="ftco-footer-widget mb-4">
              <h2 class="ftco-heading-2">Vous avez des questions ?</h2>
              <div class="block-23 mb-3">
                <ul>
                  <li>
                    <span class="icon icon-map-marker"></span
                    ><span class="text"
                      >203 Fake St. Mountain View, San Francisco, California,
                      USA</span
                    >
                  </li>
                  <li>
                    <a href="#"
                      ><span class="icon icon-phone"></span
                      ><span class="text">+2 392 3929 210</span></a
                    >
                  </li>
                  <li>
                    <a href="#"
                      ><span class="icon icon-envelope"></span
                      ><span class="text">info@yourdomain.com</span></a
                    >
                  </li>
                </ul>
              </div>
            </div>
          </div>
        </div>
        <div class="row">
          <div class="col-md-12 text-center">
            <p>
              Copyright &copy;
              <script>
                document.write(new Date().getFullYear());
              </script>
              Tous droits réservés | Ce modèle est réalisé avec
              <i class="icon-heart color-danger" aria-hidden="true"></i> par
              <a href="https://colorlib.com" target="_blank">Colorlib</a>
            </p>
          </div>
        </div>
      </div>
    </footer>
    {% endblock footer %}

    <!-- loader -->
    <div id="ftco-loader" class="show fullscreen">
      <svg class="circular" width="48px" height="48px">
        <circle
          class="path-bg"
          cx="24"
          cy="24"
          r="22"
          fill="none"
          stroke-width="4"
          stroke="#eeeeee"
        />
        <circle
          class="path"
          cx="24"
          cy="24"
          r="22"
          fill="none"
          stroke-width="4"
          stroke-miterlimit="10"
          stroke="#F96D00"
        />
      </svg>
    </div>
    {% block extraScript %}
    <script src="{% static 'js/jquery.min.js' %}"></script>
    <script src="{% static 'js/jquery-migrate-3.0.1.min.js' %}"></script>
    <script src="{% static 'js/popper.min.js' %}"></script>
    <script src="{% static 'js/bootstrap.min.js' %}"></script>
    <script src="{% static 'js/jquery.easing.1.3.js' %}"></script>
    <script src="{% static 'js/jquery.waypoints.min.js' %}"></script>
    <script src="{% static 'js/jquery.stellar.min.js' %}"></script>
    <script src="{% static 'js/owl.carousel.min.js' %}"></script>
    <script src="{% static 'js/jquery.magnific-popup.min.js' %}"></script>
    <script src="{% static 'js/aos.js' %}"></script>
    <script src="{% static 'js/jquery.animateNumber.min.js' %}"></script>
    <script src="{% static 'js/bootstrap-datepicker.js' %}"></script>
    <script src="{% static 'js/jquery.timepicker.min.js' %}"></script>
    <script src="{% static 'js/scrollax.min.js' %}"></script>
    <script src="https://maps.googleapis.com/maps/api/js?key=AIzaSyBVWaKrjvy3MaE7SQ74_uJiULgl1JY0H2s&sensor=false"></script>
    <script src="{% static 'js/google-map.js' %}"></script>
    <script src="{% static 'js/main.js' %}"></script>
    <script>
      // Fonction pour ajouter un véhicule au panier
      function ajouterAuPanier(vehicleId) {
        let cart = JSON.parse(localStorage.getItem("cart")) || [];
        if (!cart.includes(vehicleId)) {
          cart.push(vehicleId);
          localStorage.setItem("cart", JSON.stringify(cart));
                    mettreAJourCompteurPanier();
          showToast("Véhicule ajouté au panier!");
        } else {
          showToast("Véhicule déjà dans le panier!");
        }
      }

      // Fonction pour afficher les véhicules dans le panier
      function afficherPanier() {
        let cart = JSON.parse(localStorage.getItem("cart")) || [];
        // Logique pour afficher les véhicules dans le panier
        console.log("Véhicules dans le panier:", cart);
      }

      // Appel de la fonction pour afficher le panier au chargement de la page
      document.addEventListener("DOMContentLoaded", afficherPanier);

       function mettreAJourCompteurPanier() {
        let cart = JSON.parse(localStorage.getItem("cart")) || [];
        document.getElementById("cart-count").textContent = cart.length; // Met à jour le compteur
      }

      // Appel de la fonction pour afficher le panier au chargement de la page
      document.addEventListener("DOMContentLoaded", function() {
        afficherPanier();
        mettreAJourCompteurPanier(); // Met à jour le compteur au chargement
      });

      function showToast(message) {
     const toastHTML = `
      <div class="toast" style="position: fixed; top: 50%; left: 50%; transform: translate(-50%, -50%); background-color: rgba(0, 0, 0, 0.8); color: white; padding: 20px; border-radius: 5px; font-size: 1.5em;" role="alert" aria-live="assertive" aria-atomic="true">
        <div class="toast-body">
          ${message}
        </div>
      </div>
    `;
    document.body.insertAdjacentHTML('beforeend', toastHTML);
    const toastElement = document.querySelector('.toast');
    const toast = new bootstrap.Toast(toastElement);
    toast.show();
    setTimeout(() => {
      toastElement.remove();
    }, 3000); // Supprime le toast après 3 secondes

  }

    function removeFromCart(vehicleId) {
    let cart = JSON.parse(localStorage.getItem("cart")) || [];
    cart = cart.filter((id) => id !== vehicleId);
    localStorage.setItem("cart", JSON.stringify(cart));
    showToast("Véhicule supprimé du panier!"); // Remplace l'alerte par un toast
    location.reload();
  }
    </script>
    {% endblock extraScript %}
  </body>
</html>
